# Production Environment Variables
# Copy this file to .env and fill in your values
# CRITICAL: Never commit .env to Git!

# =============================================================================
# SECURITY CONFIGURATION (CRITICAL)
# =============================================================================

# JWT Secret Key - Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
SECRET_KEY=CHANGE_THIS_TO_A_SECURE_RANDOM_STRING_MIN_256_BITS

# Algorithm for JWT (do not change unless you know what you're doing)
JWT_ALGORITHM=HS256

# Token expiration times
ACCESS_TOKEN_EXPIRE_MINUTES=15
REFRESH_TOKEN_EXPIRE_DAYS=7

# Account lockout settings
MAX_FAILED_LOGIN_ATTEMPTS=5
ACCOUNT_LOCKOUT_DURATION_SECONDS=3600  # 1 hour

# 2FA settings
TWO_FACTOR_ISSUER_NAME=Financial Security API
TWO_FACTOR_BACKUP_CODES_COUNT=10

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL connection string
# Format: postgresql://username:password@host:port/database
DATABASE_URL=postgresql://api_user:secure_password@localhost:5432/financial_api_prod

# Connection pool settings
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=10
DATABASE_POOL_TIMEOUT=30
DATABASE_ECHO=False  # Set True for SQL query logging (development only)

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================

# Redis connection (for token blacklist, rate limiting, session storage)
USE_REDIS=true
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=
REDIS_MAX_CONNECTIONS=10
REDIS_SOCKET_TIMEOUT=5

# Redis TTL defaults (seconds)
REDIS_TOKEN_BLACKLIST_TTL=86400  # 24 hours
REDIS_RATE_LIMIT_TTL=60
REDIS_SESSION_TTL=604800  # 7 days

# =============================================================================
# EMAIL CONFIGURATION (for security alerts)
# =============================================================================

# SMTP Server Settings
# For Gmail: Use App Password (https://support.google.com/accounts/answer/185833)
# For AWS SES: Use SMTP credentials
# For SendGrid: smtp.sendgrid.net:587
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password-here
SMTP_FROM_EMAIL=noreply@yourdomain.com
SMTP_FROM_NAME=Financial Security API

# Email alert recipients
ADMIN_EMAIL=admin@yourdomain.com
SECURITY_ALERT_EMAIL=security@yourdomain.com

# Email features
EMAIL_ALERTS_ENABLED=true
EMAIL_RATE_LIMIT_PER_HOUR=100

# =============================================================================
# CORS & SECURITY HEADERS
# =============================================================================

# CORS allowed origins (comma-separated, no spaces)
# Production: Only list your frontend domain(s)
# Development: http://localhost:3000,http://localhost:8080
ALLOWED_ORIGINS=https://yourdomain.com,https://www.yourdomain.com

# CORS settings
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOW_HEADERS=Content-Type,Authorization,X-CSRF-Token

# CSRF Protection
CSRF_PROTECTION_ENABLED=true
CSRF_SECRET_KEY=CHANGE_THIS_DIFFERENT_FROM_JWT_SECRET
CSRF_COOKIE_SAMESITE=strict
CSRF_COOKIE_SECURE=true

# =============================================================================
# RATE LIMITING
# =============================================================================

RATE_LIMIT_ENABLED=true

# Per-endpoint rate limits (requests per minute)
RATE_LIMIT_LOGIN=5
RATE_LIMIT_REGISTER=3
RATE_LIMIT_2FA=10
RATE_LIMIT_PORTFOLIO=60
RATE_LIMIT_PREDICTIONS=20
RATE_LIMIT_PRICES=60
RATE_LIMIT_NEWS=30
RATE_LIMIT_DEFAULT=60

# Global rate limiting
MAX_CONCURRENT_REQUESTS=100
REQUEST_QUEUE_TIMEOUT=30

# =============================================================================
# API KEYS (External Services)
# =============================================================================

# Financial Data APIs
ALPHA_VANTAGE_API_KEY=your-alpha-vantage-key-here
TWELVE_DATA_API_KEY=your-twelve-data-key-here
BINANCE_API_KEY=your-binance-key-here
BINANCE_API_SECRET=your-binance-secret-here

# News & Sentiment APIs
NEWS_API_KEY=your-news-api-key-here
FINNHUB_API_KEY=your-finnhub-key-here

# =============================================================================
# SERVER CONFIGURATION
# =============================================================================

# Environment: development | staging | production
ENVIRONMENT=production

# Debug mode (NEVER set to True in production!)
DEBUG=False

# Server
HOST=0.0.0.0
PORT=8000
WORKERS=4  # CPU cores Ã— 2 + 1

# Logging
LOG_LEVEL=INFO  # DEBUG | INFO | WARNING | ERROR | CRITICAL
LOG_FILE_PATH=logs/app.log
SECURITY_LOG_FILE_PATH=logs/security.log
LOG_ROTATION_SIZE_MB=100
LOG_RETENTION_DAYS=90

# =============================================================================
# SSL/HTTPS
# =============================================================================

# SSL Certificate paths (for HTTPS)
SSL_ENABLED=true
SSL_CERT_PATH=/etc/letsencrypt/live/yourdomain.com/fullchain.pem
SSL_KEY_PATH=/etc/letsencrypt/live/yourdomain.com/privkey.pem

# Force HTTPS redirect
FORCE_HTTPS=true

# HSTS (HTTP Strict Transport Security)
HSTS_MAX_AGE=31536000  # 1 year
HSTS_INCLUDE_SUBDOMAINS=true

# =============================================================================
# MONITORING & OBSERVABILITY
# =============================================================================

# Error tracking (Sentry)
SENTRY_DSN=https://your-sentry-dsn-here
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# Application Performance Monitoring
APM_ENABLED=false
APM_SERVICE_NAME=financial-api
DATADOG_API_KEY=your-datadog-key-here

# Health check
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_ENDPOINT=/api/v1/health

# =============================================================================
# MACHINE LEARNING
# =============================================================================

# Model configuration
ML_MODEL_PATH=models/predictor.pkl
ML_PREDICTION_CONFIDENCE_THRESHOLD=0.7
ML_CACHE_PREDICTIONS=true
ML_CACHE_TTL=3600  # 1 hour

# =============================================================================
# FEATURE FLAGS
# =============================================================================

# Enable/disable features
FEATURE_2FA_ENABLED=true
FEATURE_EMAIL_ALERTS_ENABLED=true
FEATURE_ML_PREDICTIONS_ENABLED=true
FEATURE_SWAGGER_DOCS_ENABLED=false  # Disable in production
FEATURE_ADMIN_PANEL_ENABLED=false

# =============================================================================
# BACKUP & DISASTER RECOVERY
# =============================================================================

# Backup configuration
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM (cron format)
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=your-backup-bucket-name
BACKUP_S3_REGION=us-east-1

# =============================================================================
# COMPLIANCE & LEGAL
# =============================================================================

# Data retention policies
USER_DATA_RETENTION_DAYS=365
LOG_DATA_RETENTION_DAYS=90
DELETED_USER_RETENTION_DAYS=30  # For GDPR compliance

# Terms & Privacy
TERMS_OF_SERVICE_URL=https://yourdomain.com/terms
PRIVACY_POLICY_URL=https://yourdomain.com/privacy

# =============================================================================
# DEVELOPMENT ONLY (Remove in production)
# =============================================================================

# Use in-memory storage (development only)
USE_IN_MEMORY_DB=false
USE_IN_MEMORY_REDIS=false

# Allow HTTP (development only)
ALLOW_HTTP=false

# Swagger UI (development only)
DOCS_URL=/docs
REDOC_URL=/redoc

# Feature Flags
ENABLE_ML_PREDICTIONS=True
ENABLE_WEBSOCKETS=True
ENABLE_PORTFOLIO=True
ENABLE_DEVICE_FINGERPRINTING=True

# Performance
MAX_PREDICTION_QUEUE_SIZE=50
MAX_PORTFOLIO_QUEUE_SIZE=100
REQUEST_TIMEOUT_SECONDS=30

# Account Security
ACCOUNT_LOCKOUT_ATTEMPTS=5
ACCOUNT_LOCKOUT_DURATION_MINUTES=60
TOKEN_EXPIRATION_MINUTES=30
REFRESH_TOKEN_EXPIRATION_DAYS=7
